# Go 后端代码审查参考规范

## 功能正确性
- 核查业务逻辑与需求一致：分支覆盖正常/异常/边界路径；返回值与状态码符合约定。
- 输入校验充分：HTTP 参数/JSON 解析错误时清晰报错；必填项、长度、范围、枚举、格式均校验。
- 异常处理：错误链保留上下文，避免 panic；失败时保证资源回收与事务一致性。

## Go 语言规范
- 命名简洁、语义清晰，导出与非导出遵循首字母大小写；避免缩写滥用。
- 包/文件组织清晰，职责单一；避免循环依赖。
- 错误处理遵循 `if err != nil { ... }`；必要时使用哨兵错误或包装错误。

## 代码简洁与复用
- 去重公共逻辑，优先复用已有工具/函数；避免硬编码魔法数，使用常量配置。
- 结构体字段与标签一致性（json/toml/db），避免隐式依赖。
- 控制函数/方法长度，拆分明显子逻辑，保持可读性。

## HTTP 接口
- 路由与方法匹配语义；状态码规范（200/201/204，4xx 客户端，5xx 服务端）。
- 参数校验、默认值与错误返回格式一致；响应字段脱敏。
- 幂等性与安全性考虑：重复请求、重放、CSRF/鉴权检查（如适用）。

## 性能与安全
- 避免不必要的分配与拷贝；热点路径注意锁粒度与数据结构选择。
- SQL/GORM 防止注入，使用参数化；查询范围、分页、索引使用合理。
- 敏感信息不落日志；使用配置文件注入；外部调用添加超时与重试策略。

## 可测试性
- 关键逻辑具备单测/表驱动用例；边界与异常场景覆盖。
- 抽象外部依赖（DB、HTTP）以便 mock；避免全局可变状态。
- 配置、时间、随机等通过注入或接口控制，保证可预测。

## 日志与可观测性
- 日志包含上下文（请求 id、关键参数），避免过度或缺失；敏感数据脱敏。
- 错误级别区分（info/warn/error），无意义的打印应移除。
- 重要操作与失败路径有监控/指标留钩子（如适用）。
